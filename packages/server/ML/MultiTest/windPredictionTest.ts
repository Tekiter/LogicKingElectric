import * as tf from "@tensorflow/tfjs";
import "@tensorflow/tfjs-node";

async function load(sample: tf.Tensor3D) {
    const model = await tf.loadLayersModel("file://./ML/MultiTest/model.json");
    const res = model.predict(sample);
    //console.log((res as tf.Tensor).dataSync()[0]);
    const model_prediction = (res as tf.Tensor).dataSync()[0];
    return model_prediction;
}

const dummy = tf.tensor3d([
    [
        [1.20734575, -0.54046012, -0.42342617],
        [1.20734575, -0.54040263, -0.42373661],
        [1.3834888, -0.54033365, -0.42401255],
        [1.30070617, -0.54033365, -0.42429999],
        [0.98567225, -0.54046012, -0.42340318],
        [-0.3374702, -0.54042563, -0.42387458],
        [1.81073918, -0.54041413, -0.4242425],
        [2.45322441, -0.54027616, -0.42462192],
        [3.65587214, -0.54047162, -0.42405854],
        [4.56970045, -0.54028766, -0.42440347],
        [3.39970588, -0.54044862, -0.42458743],
        [0.5745185, -0.54036814, -0.42392057],
        [-0.39633785, -0.54044862, -0.42370211],
        [0.89645097, -0.54046012, -0.42369061],
        [0.15968551, -0.54035664, -0.42433448],
        [-0.5200519, -0.54026466, -0.42450694],
        [-0.4280712, -0.54039114, -0.42389757],
        [2.11197599, -0.54046012, -0.42366762],
        [2.41689203, -0.54044862, -0.4237711],
        [0.9525592, -0.54046012, -0.42413902],
    ],
]);
// kWh 단위의 20일치 [발전량, 풍속, 기압]
// mean: 4703.139041666667 std: 8697.476203780127
const std = 8697.476203780127;
const mean = 4703.139041666667;
const res = load(dummy);
res.then(val => console.log(val * std + mean));
